clear
clc
close all


% filtro media movel : 5
a =[0.00 0.00
0.50 0.00
1.00 0.00
1.50 0.00
2.00 0.05
2.50 -0.32
3.00 0.28
3.50 0.56
4.00 0.65
4.50 -0.38
5.00 1.08
5.50 1.29
6.00 1.82
6.50 1.83
7.00 2.10
7.50 2.54
8.00 1.47
8.50 2.85
9.00 2.86
9.50 3.47
10.00 3.23
10.50 3.89
11.00 3.13
11.50 3.93
12.00 4.21
12.50 4.64
13.00 4.71
13.50 5.20
14.00 5.54
14.50 5.36
15.00 5.17
15.50 5.17
16.00 5.24
16.50 4.98
17.00 5.68
17.50 5.83
18.00 6.29
18.50 6.57
19.00 7.00
19.50 7.16
20.00 7.39
20.50 7.65
21.00 7.85
21.50 7.76
22.00 7.99
22.50 8.24
23.00 8.44
23.50 8.48
24.00 8.75
24.50 8.89
25.00 8.91
25.50 8.96
26.00 9.17
26.50 9.27
27.00 9.26
27.50 9.31
28.00 9.35
28.50 9.42
29.00 9.62
29.50 9.73
30.00 9.72
30.50 9.63
31.00 9.65
31.50 9.50
32.00 9.63
32.50 9.78
33.00 9.89
33.50 10.13
34.00 9.97
34.50 10.16
35.00 9.91
35.50 9.90
36.00 10.07
36.50 10.15
37.00 10.38
37.50 10.50
38.00 10.49
38.50 10.67
39.00 10.61
39.50 10.53
40.00 10.50
40.50 10.48
41.00 10.77
41.50 10.88
42.00 11.02
42.50 10.98
43.00 10.73
43.50 10.93
44.00 10.92
44.50 10.99
45.00 10.88
45.50 10.88
46.00 10.98
46.50 11.19
47.00 11.31
47.50 11.28
48.00 11.46
48.50 11.53
49.00 11.60
49.50 11.65
50.00 11.84
50.50 11.78
51.00 11.82
51.50 11.82
52.00 11.70
52.50 11.78
53.00 11.78
53.50 11.81
54.00 11.68
54.50 11.66
55.00 11.18
55.50 10.57
56.00 11.22
56.50 11.08
57.00 11.25
57.50 11.39
58.00 11.50
58.50 11.58
59.00 11.65
59.50 11.72
60.00 11.64
];


t = a(:,1);
y = a(:,2);

u=100*ones(1,length(a));
plot(t,y,'b','linewidth',2),grid, hold on

%%GRAFICO DE MALHA FECHADA
d=[0.00 0.00
0.50 0.00
1.00 0.00
1.50 0.00
2.00 -0.06
2.50 -0.04
3.00 0.24
3.50 0.10
4.00 0.18
4.50 0.46
5.00 0.71
5.50 0.76
6.00 0.98
6.50 0.95
7.00 0.98
7.50 0.87
8.00 0.97
8.50 0.97
9.00 0.86
9.50 0.97
10.00 0.98
10.50 0.57
11.00 0.58
11.50 0.70
12.00 0.65
12.50 0.80
13.00 0.70
13.50 0.87
14.00 0.77
14.50 0.90
15.00 0.91
15.50 0.96
16.00 0.82
16.50 0.93
17.00 0.51
17.50 0.68
18.00 0.45
18.50 0.57
19.00 0.54
19.50 0.30
20.00 0.22
20.50 0.56
21.00 0.65
21.50 0.79
22.00 0.85
22.50 0.92
23.00 0.67
23.50 0.86
24.00 0.47
24.50 0.25
25.00 0.50
25.50 0.06
26.00 0.30
26.50 0.23
27.00 0.45
27.50 0.50
28.00 0.72
28.50 0.68
29.00 0.87
29.50 0.35
30.00 0.66
30.50 0.63
31.00 0.80
31.50 1.01
32.00 1.13
32.50 0.98
33.00 0.92
33.50 0.97
34.00 0.83
34.50 0.89
35.00 0.74
35.50 0.58
36.00 0.47
36.50 0.53
37.00 0.40
37.50 0.49
38.00 0.50
38.50 0.69
39.00 0.61
39.50 0.78
40.00 0.51
40.50 0.48
41.00 0.53
41.50 0.38
42.00 0.47
42.50 -0.22
43.00 0.16
43.50 0.36
44.00 0.56
44.50 0.55
45.00 0.64
45.50 0.51
46.00 0.65
46.50 0.93
47.00 0.92
47.50 1.01
48.00 1.01
48.50 1.05
49.00 0.89
49.50 0.84
50.00 0.90
50.50 0.60
51.00 0.51
51.50 0.54
52.00 0.54
52.50 0.54
53.00 0.48
53.50 0.54
54.00 0.23
54.50 0.31
55.00 0.24
55.50 0.56
56.00 0.62
56.50 0.61
57.00 0.34
57.50 -0.22
58.00 0.27
58.50 0.54
59.00 0.66
59.50 0.79
60.00 0.72
];

td = d(:,1);
yd = d(:,2);

%plot(td,yd,'r','linewidth',2),grid, hold on

%PARAMETROS
ts=10;
erro=0.1*17;

%PARTE REAL DO PO
Po_=-4/ts;

%CALCULO DO K PARA s=Po_
K=1/(abs(22.51*Po_+0.01275)/abs(300.55*Po_^2+36*Po_+1))

%CALCULO DO ERRO
erroatual=5.1/(1+K*0.01275)


%% modelo
%PROJETO DO CONTROLADOR

Km = 0.11981;
Tp1 = 14.806;
Tp2 = 4.4592;
G = tf(Km/(Tp1*Tp2),conv([1 1/Tp1] ,[1 1/Tp2]));

%% controlador

Kc = abs(Po_)/(Km/(Tp1*Tp2));
C = Kc*tf(conv([1 1/Tp1] ,[1 1/Tp2]),[1 0]);

%% Discretizar

dt = 0.5;
Cd = c2d(C,dt,'tustin');
figure
rlocus(G*C);